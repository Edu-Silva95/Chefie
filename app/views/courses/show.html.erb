<div class="show_course">
  <div class="show_course__header">

  <div class="show_course__back-wrapper">
    <%= link_to courses_path, class: "custom-back-btn-link custom-back-btn-link--full-two" do %>
      <span>← Back to All Courses</span>
    <% end %>
  </div>

    <div class="show_course__average-rating">
      <strong>Average Rating:</strong>
      <%= @course.average_rating %> / 5
    </div>

    <h1 class="show_course__title"><%= @course.name %></h1>
    <p class="show_course__author">By <%= @course.user.username %></p>
  </div>

  <% youtube_id = extract_youtube_id(@course.youtube_url) %>
  <div class="show_course__image-wrapper">
    <% if youtube_id.present? %>
    <div class="show_course__video-wrapper">
      <iframe
        width="100%"
        height="315"
        src="https://www.youtube.com/embed/<%= youtube_id %>"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    </div>
    <% else %>
      <%= image_tag "placeholder.jpg", alt: "No video available", class: "show_course__image" %>
    <% end %>
  </div>

  <div class="show_course__description">
    <h2>Description</h2>
    <p><%= @course.description.presence || "No description available." %></p>
  </div>

  <div class="show_course__rating">
    <h2>Rate this Course</h2>

    <% if @user_rating.present? %>
      <p>You rated this course: <%= @user_rating %> ★</p>
    <% else %>
      <form action="<%= course_ratings_path(@course) %>" method="post" class="rating-form">
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>

        <div class="star-rating">
          <% 5.downto(1) do |star| %>
            <input
              type="radio"
              id="star-<%= star %>"
              name="rating[value]"
              value="<%= star %>"
              <%= "checked" if @user_rating.to_i == star %>
            >
            <label class="star" for="star-<%= star %>">&#9733;</label>
          <% end %>
        </div>

        <button type="submit" class="btn-submit-rating">
          <span class="shadow"></span>
          <span class="edge"></span>
          <span class="front text">Submit Rating</span>
        </button>
      </form>
    <% end %>
  </div>
</div>
